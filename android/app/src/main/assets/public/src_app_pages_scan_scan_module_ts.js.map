{"version":3,"file":"src_app_pages_scan_scan_module_ts.js","mappings":"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","sources":["./src/app/pages/scan/scan-routing.module.ts","./src/app/pages/scan/scan.module.ts","./src/app/pages/scan/scan.page.ts","./src/app/services/api.service.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ScanPage } from './scan.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ScanPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ScanPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ScanPageRoutingModule } from './scan-routing.module';\n\nimport { ScanPage } from './scan.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ScanPageRoutingModule\n  ],\n  declarations: [ScanPage]\n})\nexport class ScanPageModule {}\n","import { Component, OnInit } from '@angular/core';\n\n// Servicios\nimport { ApiService } from 'src/app/services/api.service';\nimport { SesionService } from 'src/app/services/sesion.service';\nimport { BdLocalService } from 'src/app/services/bd-local.service';\n\n// Plugins\nimport { BarcodeScanner, BarcodeScanResult, BarcodeScannerOptions } from '@ionic-native/barcode-scanner/ngx';\n\n@Component({\n  selector: 'app-scan',\n  templateUrl: './scan.page.html',\n  styleUrls: ['./scan.page.scss'],\n})\nexport class ScanPage implements OnInit {\n\n  code: any;\n  asignaturas: any;\n\n  clase = {\n    codigo: \" \",\n    asignatura : \" \",\n    seccion : \" \",\n    profesor: \" \",\n    fecha: \" \",\n    hora: \" \",\n  }\n\n  constructor(\n    private scanner: BarcodeScanner,\n    private api: ApiService,\n    private bdlocal: BdLocalService,\n    private sesion: SesionService) { }\n  \n  ngOnInit() {\n    console.log('ngOnInit')\n    this.startScan();\n  }\n\n  validarHorario(hra_ini, min_ini, hra_ter, min_ter){\n    let fecha = new Date();\n    let hora = fecha.getHours();\n    let min = fecha.getMinutes();\n    if (hora >= hra_ini && min >= min_ini && hora < hra_ter || hora == hra_ter && min <= min_ter) {\n      return true;\n    } else {\n      return false;\n    }  \n  }\n\n  matchClass(){\n    this.api.getAsignaturas().subscribe((data)=>{\n      this.asignaturas = data.asignatura \n      console.log(data);\n\n      let hoy = new Date().getDay();\n      console.log(hoy);\n\n      for (let i = 0; i < this.asignaturas.length; i++) {\n        //for (let j = 0; j < this.asignaturas[i].horario.length; j++) {\n          if (this.asignaturas[i].codigo.toUpperCase() == this.code.toUpperCase()) { // && this.asignaturas[i].horario[j].dia == hoy\n\n            //if (this.validarHorario(this.asignaturas[i].horario[0].hra_ini, this.asignaturas[i].horario[0].min_ini, this.asignaturas[i].horario[0].hra_ter, this.asignaturas[i].horario[0].min_ter)) {\n              this.clase.codigo = this.asignaturas[i].codigo;\n              this.clase.asignatura = this.asignaturas[i].nombre;\n              this.clase.seccion = this.asignaturas[i].seccion;\n              this.clase.profesor = this.asignaturas[i].profesor;\n              this.clase.fecha = new Date().toLocaleDateString();\n              this.clase.hora = new Date().toLocaleTimeString();\n            //} else {\n            // alert(\"No es el horario de la clase\");\n            //}\n          } \n        //}\n      }\n    })\n  }\n\n  startScan(){\n    this.scanner.scan().then(barcodeData => {\n      this.code = barcodeData.text;\n      this.matchClass();\n    }).catch(err => {\n        console.log('Error de this.scanner.scan() linea 87', err);\n    });\n    }\n\n  registrarAsistencia(){\n    let idAsistencia = this.bdlocal.generarIdAsistencia(this.clase.codigo, this.clase.fecha);\n    let alumno = this.sesion.correo;\n    this.bdlocal.guardarAsistencia(idAsistencia,alumno, this.clase.codigo, this.clase.seccion, this.clase.fecha, this.clase.hora, true);\n  }\n\n}","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpErrorResponse } from '@angular/common/http';\nimport { retry, catchError } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\n\nexport class ApiService {\n\n  httpOptions = {\n    headers: new HttpHeaders\n      ({\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*'\n      })\n  } // Se establece la base url del API a consumir\n  \n apiURL = 'https://pcortesduoc.github.io/movilApi/clase.json' // Fuente Original funciona solo get\n //apiURL = 'http://192.168.0.6:3000'; // Ejecuta json-server -H ip .\\db.json para ejecutar un Fake APIRest\n\n  constructor(private http: HttpClient) { }\n\n  getAsignaturas():Observable<any>{\n    return this.http.get(this.apiURL).pipe(\n      retry(3)\n    );\n  }\n\n  // otros metodos\n\n  getPosts(): Observable<any> {\n    return this.http.get(this.apiURL + '/posts/').pipe(retry(3));\n  }\n\n  getPost(id): Observable<any> {\n    return this.http.get(this.apiURL + '/posts/' + id).pipe(retry(3));\n  }\n\n  createPost(post): Observable<any> {\n    return this.http.post(this.apiURL + '/posts', post, this.httpOptions).pipe(retry(3));\n  }\n\n  updatePost(id, post): Observable<any> {\n    return this.http.put(this.apiURL + '/posts/' + id, post, this.httpOptions).pipe(retry(3));\n  }\n\n  deletePost(id): Observable<any> {\n    return this.http.delete(this.apiURL + '/posts/' + id, this.httpOptions);\n  }\n\n}"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}